!function(e,t){function n(t,n){t=e(t);var a=window.innerHeight,i=window.innerWidth,o=t.height(),r=t.width(),c={};switch(n){case"top":c.top=-(a/2+o)+"px",c.left="50%";break;case"left":c.left=-(i/2+r)+"px",c.top="50%";break;case"right":c.left=i/2+1.5*r+"px",c.top="50%";break;case"bottom":c.top=a+2*o+"px",c.left="50%"}return c}function a(){e("head").append('<link rel="stylesheet" href="../src/hp-metrics.css" type="text/css"</link>')}function i(e,t,n){var a=document.createElement(e);return a.classList.add(t),n&&(a.innerHTML=n),a}e.fn.hpModal=function(t,a,i){var o={},r={},c=e.extend({entrance:"fade",startPlacement:"top",speed:"fast",removeBackground:!1},a);switch(o={slide:function(t){var a,o={};switch(c.startPlacement){case"right":a="left";break;case"bottom":a="top";break;default:a=c.startPlacement}o[a]="50%",e(".hp-metrics-modal__background",t.toggle()).fadeIn("fast",function(){e(".hp-metrics-modal__inner",t).toggle(!0).css(n(d,c.startPlacement)).animate(o,c.speed,i())})},fade:function(t){e(".hp-metrics-modal__background",t).toggle(),t.fadeIn("fast",function(){e(".hp-metrics-modal__inner",t).fadeIn(c.speed,i())})}},r={slide:function(t){e(".hp-metrics-modal__inner",t).animate(n(d,c.startPlacement),c.speed,i()).toggle(!1),c.removeBackground!==!1&&e(".hp-metrics-modal__background",t).fadeOut("fast",function(){e(".hp-metrics-modal").toggle()})},fade:function(t){t.fadeOut("fast",function(){e(".hp-metrics-modal__inner",t).fadeOut(c.speed,i()),c.removeBackground!==!1&&e(".hp-metrics-modal__background",t).fadeOut("fast")})}},t){case"open":o[c.entrance](this);break;case"replaceContent":var d=e(".hp-metrics-modal__inner");d.html(c.content),"undefined"!=typeof i&&i();break;case"close":r[c.entrance](this)}return this},e.hpMetrics=function(n){var o,r=e.extend({entrance:"fade",startPlacement:"top",speed:"fast",removeBackground:!1},n);a(),t.sendAnalytics=function(n,a){e.ajax({type:"POST",url:"http://hopo.dev/cors/"+a,data:n,crossDomain:!0,success:function(e){t.analyticsCallBacks[e.callback](e)},error:function(e,t,n){window.console.log(e,t,n)}})},t.analyticsCallBacks={zipRequired:function(e){t.redirectURL=e.redirect_to,o.hpModal("replaceContent",{content:t.createZipContent()})},zipNotRequired:function(e){o.hpModal("replaceContent",{content:t.createOutroContent()}),o.hpModal("close",r,function(){t.redirectPage(e.redirect_to)})},zipValidate:function(e){e.zip?(t.redirectURL=t.redirectURL+"&zip="+e.zip,t.redirectPage(t.redirectURL)):t.resolveWarning("Invalid Zip Code.")}},t.redirectPage=function(e,t){var n=e;if(t){n+="?";for(var a in t)n=n+a+"="+t[a]+"&";n=n.replace(/&$/,"")}window.location.assign(n)},t.createModal=function(){var n,a,i=document.createElement("div");return i.classList.add("hp-metrics-modal"),n=document.createElement("div"),n.classList.add("hp-metrics-modal__background"),i.appendChild(n),a=document.createElement("div"),a.classList.add("hp-metrics-modal__inner"),contents=t.createInitialContent(),a.appendChild(contents),i.appendChild(a),e("body").append(i),e(i)},t.createCloseButton=function(){var e;return e=i("a","hp-metrics-modal__close","Close"),e.setAttribute("href",""),e},t.submitZip=function(){var n=e(".hp-metrics-modal__zip-field").val();/^\d{5}$/.test(n)?t.sendAnalytics({zip:n},"validate_zip"):t.resolveWarning("Invalid Zip Code.")},t.resolveWarning=function(t){"undefined"==typeof t?(t="",e(".hp-metrics-modal__zip-field").attr("data-hp-metrics__error","false")):e(".hp-metrics-modal__zip-field").attr("data-hp-metrics__error","true"),e(".hp-metrics-modal__error").text(t)},t.createInitialContent=function(){var e,n,a,o;e=i("div","hp-metrics-modal__initial"),n=i("h2","modal-header","Processing Request!"),e.appendChild(n),a=i("div","initial-loader"),o=i("div","loading-text","Loading"),a.appendChild(o);for(var r=1;3>=r;r++){var c=i("div","loader");c.classList.add("l"+r),a.appendChild(c)}return e.appendChild(a),e.appendChild(t.createCloseButton()),e},t.createZipContent=function(){var e,n,a,o,r;return e=i("div","hp-metrics-modal__zip"),a=i("h2","modal-header","Please Enter Your Zip."),e.appendChild(a),contentZip=i("div","zip-content"),o=i("input","hp-metrics-modal__zip-field"),o.setAttribute("name","zip"),o.setAttribute("type","text"),o.setAttribute("placeholder","Zip Code"),contentZip.appendChild(o),r=i("button","hp-metrics-modal__zip-submit","Submit"),contentZip.appendChild(r),n=i("div","hp-metrics-modal__error"),contentZip.appendChild(n),e.appendChild(contentZip),e.appendChild(t.createCloseButton()),e},t.createOutroContent=function(){var e,n,a;return e=i("div","hp-metrics-modal__outro"),n=i("h2","modal-header","Processing Request!"),e.appendChild(n),contentOutro=i("div","outro-content"),a=i("div","outro-text","Thank You!"),contentOutro.appendChild(a),e.appendChild(contentOutro),e.appendChild(t.createCloseButton()),e},t.resetModal=function(){o.hpModal("replaceContent",{content:t.createInitialContent()})},o=t.createModal(),e("[data-hp-metrics]").on("click",function(){t.vehicle=e(this).data("hp-metrics"),o.hpModal("open",r,function(){t.sendAnalytics({vehicle:t.vehicle},"analytic")})}),e(document).on("click",".hp-metrics-modal__zip-submit",function(){t.submitZip()}),e(document).on("click",".hp-metrics-modal a.hp-metrics-modal__close",function(e){e.preventDefault(),r.removeBackground=!0,o.hpModal("close",r,function(){t.resetModal()})}),e(document).on("focus",'.hp-metrics-modal input[data-hp-metrics__error="true"]',function(){t.resolveWarning()})}}(jQuery,{});